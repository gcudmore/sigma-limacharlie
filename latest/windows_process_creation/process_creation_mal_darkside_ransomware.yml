detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: or
    rules:
    - op: or
      rules:
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: =[char][byte]('0x'+
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: ' -work worker0 -path '
    - op: and
      rules:
      - case sensitive: false
        op: contains
        path: event/PARENT/COMMAND_LINE
        value: DllHost.exe /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}
      - case sensitive: false
        op: contains
        path: event/FILE_PATH
        value: \AppData\Local\Temp\
respond:
- action: report
  metadata:
    author: Florian Roth
    description: Detects DarkSide Ransomware and helpers
    falsepositives:
    - Unknown
    - UAC bypass method used by other malware
    level: critical
    references:
    - https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html
    - https://app.any.run/tasks/8b9a571b-bcc1-4783-ba32-df4ba623b9c0/
    - https://www.joesandbox.com/analysis/411752/0/html#7048BB9A06B8F2DD9D24C77F389D7B2B58D2
    tags:
    - attack.execution
    - attack.t1204
  name: DarkSide Ransomware Pattern

