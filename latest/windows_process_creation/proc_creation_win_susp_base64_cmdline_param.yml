detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: or
    rules:
    - case sensitive: false
      op: ends with
      path: event/COMMAND_LINE
      value: ==
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: == -
respond:
- action: report
  metadata:
    author: Florian Roth
    description: Detects programs that use base64 encoded values provided via command
      line, which is often an indicator of obfuscation but could also be used for
      legitimate purposes (e.g. if certain special characters would mess with the
      command line interface, enccrypted keys etc.)
    falsepositives:
    - Legitimate software that uses base64 encoded values in its command line
    level: medium
    references:
    - https://blog.malwarebytes.com/threat-intelligence/2022/04/new-uac-0056-activity-theres-a-go-elephant-in-the-room/d
  name: Base64 Encoded Command Line Param Indicator

