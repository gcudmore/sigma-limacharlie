detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - case sensitive: false
      op: ends with
      path: event/COMMAND_LINE
      value: dllhost.exe
    - case sensitive: false
      op: ends with
      path: event/FILE_PATH
      value: \dllhost.exe
respond:
- action: report
  metadata:
    author: Nasreddine Bencherchali
    description: Detects a "dllhost" spawning with no commandline arguments which
      is a very rare thing to happen and could indicate process injection activity
      or malware mimicking similar system processes
    falsepositives:
    - Unlikely
    level: high
    references:
    - https://redcanary.com/blog/child-processes/
    - https://nasbench.medium.com/what-is-the-dllhost-exe-process-actually-running-ef9fe4c19c08
    tags:
    - attack.defense_evasion
    - attack.t1055
  name: Dllhost Process With No CommandLine

