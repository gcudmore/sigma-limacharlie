detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - case sensitive: false
      op: ends with
      path: event/PARENT/FILE_PATH
      value: updata.exe
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: config
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: msdtc
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: start
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: auto
respond:
- action: report
  metadata:
    author: Bhabesh Raj
    description: Detects the use of Pingback backdoor that creates ICMP tunnel for
      C2 as described in the trustwave report
    falsepositives:
    - Very unlikely
    level: high
    references:
    - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel
    - https://app.any.run/tasks/4a54c651-b70b-4b72-84d7-f34d301d6406
    tags:
    - attack.persistence
    - attack.t1574.001
  name: Pingback Backdoor

