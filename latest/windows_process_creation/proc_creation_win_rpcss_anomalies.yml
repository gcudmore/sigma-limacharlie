detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - case sensitive: false
    op: starts with
    path: event/PARENT/COMMAND_LINE
    value: C:\WINDOWS\system32\svchost.exe -k RPCSS
respond:
- action: report
  metadata:
    author: Florian Roth
    description: Detects suspicious remote procedure call (RPC) service anomalies
      based on the spawned sub processes (long shot to detect the exploitation of
      vulnerabilities like CVE-2022-26809)
    falsepositives:
    - Unknown
    - Some cases in which the service spawned a werfault.exe process
    level: high
    references:
    - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26809
    - https://www.bleepingcomputer.com/startups/RpcSs.exe-14544.html
    - https://twitter.com/cyb3rops/status/1514217991034097664
    tags:
    - attack.initial_access
    - attack.t1190
    - attack.execution
    - attack.t1569.002
  name: Remote Procedure Call Service Anomaly

