detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: and
    rules:
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: e=Access&
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: y=Guest&
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: '&p='
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: '&c='
    - case sensitive: false
      op: contains
      path: event/COMMAND_LINE
      value: '&k='
respond:
- action: report
  metadata:
    author: Florian Roth
    description: Detects ScreenConnect program starts that establish a remote access
      to that system (not meeting, not remote support)
    falsepositives:
    - Legitimate use by administrative staff
    level: high
    references:
    - https://www.anomali.com/blog/probable-iranian-cyber-actors-static-kitten-conducting-cyberespionage-campaign-targeting-uae-and-kuwait-government-agencies
    tags:
    - attack.initial_access
    - attack.t1133
  name: ScreenConnect Remote Access

